<!DOCTYPE html>
<html>
<head>
    <title>Login - Sky Recharge</title>
    <link rel="stylesheet" href="style.css">
    <script src="api.js"></script>
</head>
<body>

<header>
    <div class="logo">
        <h2>Sky Recharge</h2>
    </div>
    <nav>
        <a href="index.html">Home</a>
        <a href="login.html">Login</a>
        <a href="register.html">Register</a>
    </nav>
</header>

<div class="form-container">
    <div class="form-box">

        <h2>Login to Your Account</h2>
        <form onsubmit="return loginUser(event)">
            <input type="email" placeholder="Email Address" required>
            <input type="password" placeholder="Password" required>
            <button type="submit" class="btn">Login</button>
            <p class="form-link">Don't have an account? <a href="register.html">Register here</a></p>
        </form>
    </div>
</div>

<footer>
    <div class="container">
        <p>Sky Recharge - Fast & Secure Mobile Recharge</p>
    </div>
</footer>

<script>
async function loginUser(event) {
    event.preventDefault();
    
    const email = document.querySelector('input[type="email"]').value;
    const password = document.querySelector('input[type="password"]').value;
    
    // Email validation
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        alert('Please enter a valid email address');
        return false;
    }
    
    // Password validation
    if (password.length < 6) {
        alert('Password must be at least 6 characters long');
        return false;
    }
    
    // Show loading
    const button = document.querySelector('button[type="submit"]');
    button.textContent = 'Logging in...';
    button.disabled = true;
    
    try {
        const response = await mockAPI.login(email, password);
        
        if (response.success) {
            localStorage.setItem('currentUser', JSON.stringify(response.data));
            localStorage.setItem('authToken', response.token);
            alert(response.message);
            window.location.href = 'dashboard.html';
        } else {
            alert(response.message);
        }
    } catch (error) {
        alert('Login failed. Please try again.');
    } finally {
        button.textContent = 'Login';
        button.disabled = false;
    }
    
    return false;
}
</script>

</body>
</html>